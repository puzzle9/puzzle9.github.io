<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta property="og:description" content="puzzle9 的博客,还在思考要怎么填充内容."><meta property="og:type" content="website"><meta name="description" content="puzzle9 的博客,还在思考要怎么填充内容."><meta name="keyword" content="puzzle9,博客写点啥"><link rel="shortcut icon" href="/img/favicon.ico"><title>airflow - puzzle9 blog</title><link rel="stylesheet" href="/css/aircloud.css"><link rel="stylesheet" href="/css/gitment.css"><link href="//cdn.bootcdn.net/ajax/libs/bootstrap-icons/1.9.1/font/bootstrap-icons.min.css" rel="stylesheet" type="text/css"><script></script><meta name="google-site-verification" content="3e4j7L_541lS0rJFqZrKpELNNYbwf2-Ed57dT7_dIJA"><script async src="https://www.googletagmanager.com/gtag/js?id=G-BKQDR65NCT"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-BKQDR65NCT")</script><meta name="msvalidate.01" content="F41A5465665E7579D1952E516D03A8A7"><meta name="baidu-site-verification" content="code-LrrIDw9dme"><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="puzzle9 blog" type="application/atom+xml"></head><body><div class="site-nav-toggle" id="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div><div class="index-about"></div><div class="index-container"><div class="index-left"><div class="nav" id="nav"><div class="avatar-name"><div class="avatar"><img src="/img/avatar.jpg"></div><div class="name"><a href="/"><i>puzzle9</i></a></div></div><div class="contents" id="nav-content"><ul><li><a href="/"><i class="bi bi-house"></i> <span>主页</span></a></li><li><a href="/tags"><i class="bi bi-journals"></i> <span>标签</span></a></li><li><a href="/archives"><i class="bi bi-journal-bookmark"></i> <span>存档</span></a></li><li><a href="/about"><i class="bi bi-person"></i> <span>关于</span></a></li><li><a href="/project_plan"><i class="bi bi-file"></i> <span>Project Plan</span></a></li><li><a href="/love_to_do"><i class="bi bi-list-task"></i> <span>Love To Do</span></a></li><li><a id="search"><i class="bi bi-search"></i> <span>搜索</span></a></li></ul></div><div id="toc" class="toc-article"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E6%8F%90"><span class="toc-text">前提</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-text">安装</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Q-A"><span class="toc-text">Q&amp;A</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#dag-%E4%B8%8D%E4%BC%9A%E5%87%BA%E6%9D%A5"><span class="toc-text">dag 不会出来</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mssql-%E7%9B%B8%E5%85%B3"><span class="toc-text">mssql 相关</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#mssql-%E8%BF%9E%E6%8E%A5%E6%97%B6%E5%80%99%E6%8A%A5-DB-Lib-error-message-20002"><span class="toc-text">mssql 连接时候报 DB-Lib error message 20002</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#oracle-%E7%9B%B8%E5%85%B3"><span class="toc-text">oracle 相关</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#DPY-4027-no-configuration-directory-specified"><span class="toc-text">DPY-4027: no configuration directory specified</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DPY-3015-password-verifier-type-0x939-is-not-supported-by-python-oracledb-in-thin-mode"><span class="toc-text">DPY-3015: password verifier type 0x939 is not supported by python-oracledb in thin mode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ORA-28726-set-current-schema-operation-failed-because-the-given-schema-name-is-either-invalid-or-does-not-exist"><span class="toc-text">ORA-28726: set current schema operation failed because the given schema name is either invalid or does not exist</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E6%9C%AC%E5%9C%B0%E5%8C%96%E8%BF%90%E8%A1%8C"><span class="toc-text">如何本地化运行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%88%A0%E9%99%A4dag%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95"><span class="toc-text">如何删除dag历史记录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B6%85%E6%97%B6%E7%9B%B8%E5%85%B3"><span class="toc-text">超时相关</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E5%9C%B0%E5%9D%80"><span class="toc-text">参考地址</span></a></li></ol></div></div><div class="search-field" id="search-field"><div class="search-bg" id="search-bg"></div><div class="search-container"><div class="search-input"><span id="esc-search"><i class="bi bi-backspace"></i></span> <input id="search-input"> <span id="begin-search">搜索</span></div><div class="search-result-container" id="search-result-container"></div></div></div><div class="index-about-mobile"><i>I exist because you need me.</i></div></div><div class="index-middle"><div class="post-container"><div class="post-title">airflow</div><div class="post-meta"><span class="attr">发布于：<span>2025-07-11 14:23:09</span></span> <span class="attr">访问：<span id="busuanzi_value_page_pv"></span></span></div><div class="post-content no-indent"><p>一款优秀的 调度工具</p><h1 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h1><p>现有版本用的 <a target="_blank" rel="noopener" href="https://github.com/pentaho/pentaho-kettle"><code>kattle</code></a><br>因为是图像界面操作 再者 不好做版本控制<br>便把目光转向了 <a target="_blank" rel="noopener" href="https://github.com/apache/airflow"><code>airflow</code></a></p><h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p>用 <code>docker</code> 呀</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://download.oracle.com/otn_software/linux/instantclient/2380000/instantclient-basic-linux.x64-23.8.0.25.04.zip</span><br><span class="line">unzip instantclient-basic-linux.x64-23.8.0.25.04.zip</span><br></pre></td></tr></table></figure><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> apache/airflow:<span class="number">3.0</span>.<span class="number">2</span></span><br><span class="line"><span class="keyword">USER</span> root</span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> sed -i <span class="string">&#x27;s#http://deb.debian.org#https://mirror.nju.edu.cn#g&#x27;</span> /etc/apt/sources.list.d/debian.sources \</span></span><br><span class="line"><span class="language-bash">  &amp;&amp; apt-get update \</span></span><br><span class="line"><span class="language-bash">  &amp;&amp; apt-get install -y --no-install-recommends \</span></span><br><span class="line"><span class="language-bash">        libaio1 \</span></span><br><span class="line"><span class="language-bash">  &amp;&amp; apt-get autoremove -yqq --purge \</span></span><br><span class="line"><span class="language-bash">  &amp;&amp; apt-get clean \</span></span><br><span class="line"><span class="language-bash">  &amp;&amp; <span class="built_in">rm</span> -rf /var/lib/apt/lists/*</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> ./instantclient_23_8 /opt/oracle_instantclient_23_8</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">echo</span> /opt/oracle_instantclient_23_8 &gt; /etc/ld.so.conf.d/oracle_instantclient.conf &amp;&amp; ldconfig</span></span><br><span class="line"><span class="keyword">USER</span> airflow</span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> pip install --proxy http://172.17.0.1:8889 -i https://mirror.nju.edu.cn/pypi/web/simple --no-cache-dir \</span></span><br><span class="line"><span class="language-bash">    <span class="string">&quot;apache-airflow==3.0.2&quot;</span> \</span></span><br><span class="line"><span class="language-bash">    apache-airflow[mysql] \</span></span><br><span class="line"><span class="language-bash">    apache-airflow[microsoft-mssql] \</span></span><br><span class="line"><span class="language-bash">    apache-airflow[odbc] \</span></span><br><span class="line"><span class="language-bash">    apache-airflow[oracle] \</span></span><br><span class="line"><span class="language-bash">    apache-airflow[postgres] \</span></span><br><span class="line"><span class="language-bash">    apache-airflow[redis] \</span></span><br><span class="line"><span class="language-bash">    apache-airflow[samba] \</span></span><br><span class="line"><span class="language-bash">    apache-airflow[http]</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker build -t puzzle9/airflow:3.0.2 .</span><br><span class="line"></span><br><span class="line"><span class="comment">#docker build -t puzzle9/airflow:3.0.2 --build-arg http_proxy=&quot;http://192.168.1.1:8888&quot; --build-arg https_proxy=&quot;http://192.168.1.1:8888&quot; .</span></span><br></pre></td></tr></table></figure><p>好了 基础镜像就出来了</p><p>再来个 <code>docker-compose.yaml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># https://airflow.apache.org/docs/apache-airflow/3.0.2/docker-compose.yaml</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">x-airflow-common:</span> <span class="string">&amp;airflow-common</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">puzzle9/airflow:3.0.2</span></span><br><span class="line">  <span class="comment"># build: .</span></span><br><span class="line">  <span class="attr">environment:</span> <span class="string">&amp;airflow-common-env</span></span><br><span class="line">    <span class="attr">AIRFLOW__CORE__DEFAULT_TIMEZONE:</span> <span class="string">Asia/Shanghai</span></span><br><span class="line">    <span class="attr">AIRFLOW__SCHEDULER__SCHEDULER_HEARTBEAT_SEC:</span> <span class="string">$&#123;AIRFLOW_SCHEDULER_HEARTBEAT_SEC&#125;</span></span><br><span class="line">    <span class="attr">AIRFLOW__DAG_PROCESSOR__MIN_FILE_PROCESS_INTERVAL:</span> <span class="string">$&#123;AIRFLOW_MIN_FILE_PROCESS_INTERVAL&#125;</span></span><br><span class="line">    <span class="attr">AIRFLOW__CORE__PARALLELISM:</span> <span class="string">$&#123;AIRFLOW_PARALLELISM&#125;</span></span><br><span class="line">    <span class="attr">AIRFLOW__CORE__MAX_ACTIVE_RUNS_PER_DAG:</span> <span class="string">$&#123;AIRFLOW_MAX_ACTIVE_RUNS_PER_DAG&#125;</span></span><br><span class="line">    <span class="attr">AIRFLOW__CORE__EXECUTOR:</span> <span class="string">$&#123;AIRFLOW_EXECUTOR&#125;</span></span><br><span class="line">    <span class="attr">AIRFLOW__CORE__AUTH_MANAGER:</span> <span class="string">airflow.providers.fab.auth_manager.fab_auth_manager.FabAuthManager</span></span><br><span class="line">    <span class="attr">AIRFLOW__DAG_PROCESSOR__DISABLE_BUNDLE_VERSIONING:</span> <span class="string">&#x27;true&#x27;</span></span><br><span class="line">    <span class="attr">AIRFLOW__DATABASE__SQL_ALCHEMY_CONN:</span> <span class="string">postgresql+psycopg2://$&#123;POSTGRES_USERNAME&#125;:$&#123;POSTGRES_PASSWORD&#125;@$&#123;POSTGRES_HOST&#125;:$&#123;POSTGRES_PORT:-5432&#125;/$&#123;POSTGRES_DATABASE&#125;</span></span><br><span class="line">    <span class="attr">AIRFLOW__CELERY__RESULT_BACKEND:</span> <span class="string">db+postgresql://$&#123;POSTGRES_USERNAME&#125;:$&#123;POSTGRES_PASSWORD&#125;@$&#123;POSTGRES_HOST&#125;:$&#123;POSTGRES_PORT:-5432&#125;/$&#123;POSTGRES_DATABASE&#125;</span></span><br><span class="line">    <span class="attr">AIRFLOW__CELERY__BROKER_URL:</span> <span class="string">redis://:$&#123;VALKEY_PASSWORD&#125;@$&#123;VALKEY_HOST&#125;:$&#123;VALKEY_PORT:-6379&#125;/$&#123;VALKEY_DATABASE:-0&#125;</span></span><br><span class="line">    <span class="attr">AIRFLOW__CORE__FERNET_KEY:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="attr">AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION:</span> <span class="string">&#x27;true&#x27;</span></span><br><span class="line">    <span class="attr">AIRFLOW__CORE__LOAD_EXAMPLES:</span> <span class="string">&#x27;false&#x27;</span></span><br><span class="line">    <span class="attr">AIRFLOW__CORE__EXECUTION_API_SERVER_URL:</span> <span class="string">&#x27;http://airflow-apiserver:8080/execution/&#x27;</span></span><br><span class="line">    <span class="attr">AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK:</span> <span class="string">&#x27;false&#x27;</span></span><br><span class="line">    <span class="attr">_PIP_ADDITIONAL_REQUIREMENTS:</span> <span class="string">$&#123;_PIP_ADDITIONAL_REQUIREMENTS:-&#125;</span></span><br><span class="line">    <span class="attr">AIRFLOW_CONFIG:</span> <span class="string">&#x27;/opt/airflow/config/airflow.cfg&#x27;</span></span><br><span class="line">  <span class="attr">volumes:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">./data/dags:/opt/airflow/dags</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">./data/logs:/opt/airflow/logs</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">./data/config:/opt/airflow/config</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">./data/plugins:/opt/airflow/plugins</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">/etc/localtime:/etc/localtime:ro</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">/etc/timezone:/etc/timezone:ro</span></span><br><span class="line">  <span class="attr">user:</span> <span class="string">&#x27;$&#123;AIRFLOW_UID:-50000&#125;:0&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">airflow-apiserver:</span></span><br><span class="line">    <span class="string">&lt;&lt;:</span> <span class="string">*airflow-common</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">api-server</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&#x27;8080:8080&#x27;</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">airflow-scheduler:</span></span><br><span class="line">    <span class="string">&lt;&lt;:</span> <span class="string">*airflow-common</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">scheduler</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">airflow-dag-processor:</span></span><br><span class="line">    <span class="string">&lt;&lt;:</span> <span class="string">*airflow-common</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">dag-processor</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">airflow-triggerer:</span></span><br><span class="line">    <span class="string">&lt;&lt;:</span> <span class="string">*airflow-common</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">triggerer</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">airflow-worker:</span></span><br><span class="line">    <span class="string">&lt;&lt;:</span> <span class="string">*airflow-common</span></span><br><span class="line">    <span class="attr">profiles:</span> [<span class="string">&#x27;airflow-worker&#x27;</span>]</span><br><span class="line">    <span class="attr">command:</span> <span class="string">celery</span> <span class="string">worker</span></span><br><span class="line">    <span class="attr">healthcheck:</span></span><br><span class="line">      <span class="comment"># yamllint disable rule:line-length</span></span><br><span class="line">      <span class="attr">test:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">&#x27;CMD-SHELL&#x27;</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">&#x27;celery --app airflow.providers.celery.executors.celery_executor.app inspect ping -d &quot;celery@$$&#123;HOSTNAME&#125;&quot; || celery --app airflow.executors.celery_executor.app inspect ping -d &quot;celery@$$&#123;HOSTNAME&#125;&quot;&#x27;</span></span><br><span class="line">      <span class="attr">interval:</span> <span class="string">30s</span></span><br><span class="line">      <span class="attr">timeout:</span> <span class="string">10s</span></span><br><span class="line">      <span class="attr">retries:</span> <span class="number">5</span></span><br><span class="line">      <span class="attr">start_period:</span> <span class="string">30s</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="string">&lt;&lt;:</span> <span class="string">*airflow-common-env</span></span><br><span class="line">      <span class="comment"># Required to handle warm shutdown of the celery workers properly</span></span><br><span class="line">      <span class="comment"># See https://airflow.apache.org/docs/docker-stack/entrypoint.html#signal-propagation</span></span><br><span class="line">      <span class="attr">DUMB_INIT_SETSID:</span> <span class="string">&#x27;0&#x27;</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">airflow-init:</span></span><br><span class="line">    <span class="string">&lt;&lt;:</span> <span class="string">*airflow-common</span></span><br><span class="line">    <span class="attr">profiles:</span> [<span class="string">&#x27;airflow-init&#x27;</span>]</span><br><span class="line">    <span class="attr">entrypoint:</span> <span class="string">/bin/bash</span></span><br><span class="line">    <span class="comment"># yamllint disable rule:line-length</span></span><br><span class="line">    <span class="attr">command:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">-c</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">|</span></span><br><span class="line"><span class="string">        if [[ -z &quot;$&#123;AIRFLOW_UID&#125;&quot; ]]; then</span></span><br><span class="line"><span class="string">          echo</span></span><br><span class="line"><span class="string">          echo -e &quot;\033[1;33mWARNING!!!: AIRFLOW_UID not set!\e[0m&quot;</span></span><br><span class="line"><span class="string">          echo &quot;If you are on Linux, you SHOULD follow the instructions below to set &quot;</span></span><br><span class="line"><span class="string">          echo &quot;AIRFLOW_UID environment variable, otherwise files will be owned by root.&quot;</span></span><br><span class="line"><span class="string">          echo &quot;For other operating systems you can get rid of the warning with manually created .env file:&quot;</span></span><br><span class="line"><span class="string">          echo &quot;    See: https://airflow.apache.org/docs/apache-airflow/stable/howto/docker-compose/index.html#setting-the-right-airflow-user&quot;</span></span><br><span class="line"><span class="string">          echo</span></span><br><span class="line"><span class="string">          export AIRFLOW_UID=$(id -u)</span></span><br><span class="line"><span class="string">        fi</span></span><br><span class="line"><span class="string">        one_meg=1048576</span></span><br><span class="line"><span class="string">        mem_available=$$(($$(getconf _PHYS_PAGES) * $$(getconf PAGE_SIZE) / one_meg))</span></span><br><span class="line"><span class="string">        cpus_available=$$(grep -cE &#x27;cpu[0-9]+&#x27; /proc/stat)</span></span><br><span class="line"><span class="string">        disk_available=$$(df / | tail -1 | awk &#x27;&#123;print $$4&#125;&#x27;)</span></span><br><span class="line"><span class="string">        warning_resources=&quot;false&quot;</span></span><br><span class="line"><span class="string">        if (( mem_available &lt; 4000 )) ; then</span></span><br><span class="line"><span class="string">          echo</span></span><br><span class="line"><span class="string">          echo -e &quot;\033[1;33mWARNING!!!: Not enough memory available for Docker.\e[0m&quot;</span></span><br><span class="line"><span class="string">          echo &quot;At least 4GB of memory required. You have $$(numfmt --to iec $$((mem_available * one_meg)))&quot;</span></span><br><span class="line"><span class="string">          echo</span></span><br><span class="line"><span class="string">          warning_resources=&quot;true&quot;</span></span><br><span class="line"><span class="string">        fi</span></span><br><span class="line"><span class="string">        if (( cpus_available &lt; 2 )); then</span></span><br><span class="line"><span class="string">          echo</span></span><br><span class="line"><span class="string">          echo -e &quot;\033[1;33mWARNING!!!: Not enough CPUS available for Docker.\e[0m&quot;</span></span><br><span class="line"><span class="string">          echo &quot;At least 2 CPUs recommended. You have $$&#123;cpus_available&#125;&quot;</span></span><br><span class="line"><span class="string">          echo</span></span><br><span class="line"><span class="string">          warning_resources=&quot;true&quot;</span></span><br><span class="line"><span class="string">        fi</span></span><br><span class="line"><span class="string">        if (( disk_available &lt; one_meg * 10 )); then</span></span><br><span class="line"><span class="string">          echo</span></span><br><span class="line"><span class="string">          echo -e &quot;\033[1;33mWARNING!!!: Not enough Disk space available for Docker.\e[0m&quot;</span></span><br><span class="line"><span class="string">          echo &quot;At least 10 GBs recommended. You have $$(numfmt --to iec $$((disk_available * 1024 )))&quot;</span></span><br><span class="line"><span class="string">          echo</span></span><br><span class="line"><span class="string">          warning_resources=&quot;true&quot;</span></span><br><span class="line"><span class="string">        fi</span></span><br><span class="line"><span class="string">        if [[ $$&#123;warning_resources&#125; == &quot;true&quot; ]]; then</span></span><br><span class="line"><span class="string">          echo</span></span><br><span class="line"><span class="string">          echo -e &quot;\033[1;33mWARNING!!!: You have not enough resources to run Airflow (see above)!\e[0m&quot;</span></span><br><span class="line"><span class="string">          echo &quot;Please follow the instructions to increase amount of resources available:&quot;</span></span><br><span class="line"><span class="string">          echo &quot;   https://airflow.apache.org/docs/apache-airflow/stable/howto/docker-compose/index.html#before-you-begin&quot;</span></span><br><span class="line"><span class="string">          echo</span></span><br><span class="line"><span class="string">        fi</span></span><br><span class="line"><span class="string">        echo</span></span><br><span class="line"><span class="string">        echo &quot;Creating missing opt dirs if missing:&quot;</span></span><br><span class="line"><span class="string">        echo</span></span><br><span class="line"><span class="string">        mkdir -v -p /opt/airflow/&#123;logs,dags,plugins,config&#125;</span></span><br><span class="line"><span class="string">        echo</span></span><br><span class="line"><span class="string">        echo &quot;Airflow version:&quot;</span></span><br><span class="line"><span class="string">        /entrypoint airflow version</span></span><br><span class="line"><span class="string">        echo</span></span><br><span class="line"><span class="string">        echo &quot;Files in shared volumes:&quot;</span></span><br><span class="line"><span class="string">        echo</span></span><br><span class="line"><span class="string">        ls -la /opt/airflow/&#123;logs,dags,plugins,config&#125;</span></span><br><span class="line"><span class="string">        echo</span></span><br><span class="line"><span class="string">        echo &quot;Running airflow config list to create default config file if missing.&quot;</span></span><br><span class="line"><span class="string">        echo</span></span><br><span class="line"><span class="string">        /entrypoint airflow config list &gt;/dev/null</span></span><br><span class="line"><span class="string">        echo</span></span><br><span class="line"><span class="string">        echo &quot;Files in shared volumes:&quot;</span></span><br><span class="line"><span class="string">        echo</span></span><br><span class="line"><span class="string">        ls -la /opt/airflow/&#123;logs,dags,plugins,config&#125;</span></span><br><span class="line"><span class="string">        echo</span></span><br><span class="line"><span class="string">        echo &quot;Change ownership of files in /opt/airflow to $&#123;AIRFLOW_UID&#125;:0&quot;</span></span><br><span class="line"><span class="string">        echo</span></span><br><span class="line"><span class="string">        chown -R &quot;$&#123;AIRFLOW_UID&#125;:0&quot; /opt/airflow/</span></span><br><span class="line"><span class="string">        echo</span></span><br><span class="line"><span class="string">        echo &quot;Change ownership of files in shared volumes to $&#123;AIRFLOW_UID&#125;:0&quot;</span></span><br><span class="line"><span class="string">        echo</span></span><br><span class="line"><span class="string">        chown -v -R &quot;$&#123;AIRFLOW_UID&#125;:0&quot; /opt/airflow/&#123;logs,dags,plugins,config&#125;</span></span><br><span class="line"><span class="string">        echo</span></span><br><span class="line"><span class="string">        echo &quot;Files in shared volumes:&quot;</span></span><br><span class="line"><span class="string">        echo</span></span><br><span class="line"><span class="string">        ls -la /opt/airflow/&#123;logs,dags,plugins,config&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">    <span class="comment"># yamllint enable rule:line-length</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="string">&lt;&lt;:</span> <span class="string">*airflow-common-env</span></span><br><span class="line">      <span class="attr">_AIRFLOW_DB_MIGRATE:</span> <span class="string">&#x27;true&#x27;</span></span><br><span class="line">      <span class="attr">_AIRFLOW_WWW_USER_CREATE:</span> <span class="string">&#x27;true&#x27;</span></span><br><span class="line">      <span class="attr">_AIRFLOW_WWW_USER_USERNAME:</span> <span class="string">$&#123;_AIRFLOW_WWW_USER_USERNAME:-airflow&#125;</span></span><br><span class="line">      <span class="attr">_AIRFLOW_WWW_USER_PASSWORD:</span> <span class="string">$&#123;_AIRFLOW_WWW_USER_PASSWORD:-airflow&#125;</span></span><br><span class="line">      <span class="attr">_PIP_ADDITIONAL_REQUIREMENTS:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="attr">user:</span> <span class="string">&#x27;0:0&#x27;</span></span><br></pre></td></tr></table></figure><p>用的是 <code>LocalExecutor</code> 模式部署的<br>所以把 <code>healthcheck</code> 也都去掉了</p><p>后端的 <code>postgresql</code> <code>redis</code> 独立部署的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># airflow</span><br><span class="line"># echo $(id -u)</span><br><span class="line">AIRFLOW_UID=1000</span><br><span class="line">AIRFLOW_SCHEDULER_HEARTBEAT_SEC=30</span><br><span class="line"># 刷新dag文件秒数 正式环境改为600</span><br><span class="line">AIRFLOW_MIN_FILE_PROCESS_INTERVAL=60</span><br><span class="line">AIRFLOW_PARALLELISM=18</span><br><span class="line">AIRFLOW_MAX_ACTIVE_RUNS_PER_DAG=16</span><br><span class="line">AIRFLOW_EXECUTOR=LocalExecutor</span><br><span class="line"></span><br><span class="line"># postgres</span><br><span class="line">POSTGRES_HOST=172.17.0.1</span><br><span class="line">POSTGRES_USERNAME=postgres</span><br><span class="line">POSTGRES_PASSWORD=postgres</span><br><span class="line">POSTGRES_DATABASE=airflow</span><br><span class="line"></span><br><span class="line"># valkey</span><br><span class="line">VALKEY_HOST=172.17.0.1</span><br><span class="line">VALKEY_PASSWORD=valkey</span><br></pre></td></tr></table></figure><p>先 <code>docker compose up airflow-init</code> 初始化<br>再 <code>docker compose up -d</code> 一键启动</p><h1 id="Q-A"><a href="#Q-A" class="headerlink" title="Q&amp;A"></a>Q&amp;A</h1><h2 id="dag-不会出来"><a href="#dag-不会出来" class="headerlink" title="dag 不会出来"></a><code>dag</code> 不会出来</h2><p>需要给 <code>执行</code> 权限 <code>chmod +x data/dags/*.py</code></p><h2 id="mssql-相关"><a href="#mssql-相关" class="headerlink" title="mssql 相关"></a>mssql 相关</h2><h3 id="mssql-连接时候报-DB-Lib-error-message-20002"><a href="#mssql-连接时候报-DB-Lib-error-message-20002" class="headerlink" title="mssql 连接时候报 DB-Lib error message 20002"></a>mssql 连接时候报 <code>DB-Lib error message 20002</code></h3><p>用这个解决</p><ul><li><a target="_blank" rel="noopener" href="https://github.com/pymssql/pymssql/issues/896">https://github.com/pymssql/pymssql/issues/896</a></li></ul><p>再 <code>connections</code> 时 <code>Extra Fields JSON</code> 中加入 <code>&#123;&quot;tds_version&quot;: &quot;7.0&quot;&#125;</code></p><h2 id="oracle-相关"><a href="#oracle-相关" class="headerlink" title="oracle 相关"></a>oracle 相关</h2><ul><li><a target="_blank" rel="noopener" href="https://airflow.apache.org/docs/apache-airflow-providers-oracle/stable/connections/oracle.html">https://airflow.apache.org/docs/apache-airflow-providers-oracle/stable/connections/oracle.html</a></li><li><a target="_blank" rel="noopener" href="https://python-oracledb.readthedocs.io/en/latest/user_guide/installation.html">https://python-oracledb.readthedocs.io/en/latest/user_guide/installation.html</a></li></ul><h3 id="DPY-4027-no-configuration-directory-specified"><a href="#DPY-4027-no-configuration-directory-specified" class="headerlink" title="DPY-4027: no configuration directory specified"></a><code>DPY-4027: no configuration directory specified</code></h3><p>再 <code>connections</code> 时 <code>Extra Fields JSON</code> 中加入 <code>&#123;&quot;service_name&quot;: &quot;orcl&quot;&#125;</code></p><h3 id="DPY-3015-password-verifier-type-0x939-is-not-supported-by-python-oracledb-in-thin-mode"><a href="#DPY-3015-password-verifier-type-0x939-is-not-supported-by-python-oracledb-in-thin-mode" class="headerlink" title="DPY-3015: password verifier type 0x939 is not supported by python-oracledb in thin mode"></a><code>DPY-3015: password verifier type 0x939 is not supported by python-oracledb in thin mode</code></h3><p>再 <code>connections</code> 时 <code>Extra Fields JSON</code> 中加入 <code>&#123;&quot;thick_mode&quot;: true, &quot;thick_mode_lib_dir&quot;: &quot;/opt/oracle_instantclient_23_8&quot;&#125;</code></p><h3 id="ORA-28726-set-current-schema-operation-failed-because-the-given-schema-name-is-either-invalid-or-does-not-exist"><a href="#ORA-28726-set-current-schema-operation-failed-because-the-given-schema-name-is-either-invalid-or-does-not-exist" class="headerlink" title="ORA-28726: set current schema operation failed because the given schema name is either invalid or does not exist"></a><code>ORA-28726: set current schema operation failed because the given schema name is either invalid or does not exist</code></h3><p>修改 <code>Schema</code> 为 库名</p><h2 id="如何本地化运行"><a href="#如何本地化运行" class="headerlink" title="如何本地化运行"></a>如何本地化运行</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --name <span class="string">&quot;airflow&quot;</span> -d -p 8080:8080 --<span class="built_in">env</span> <span class="string">&quot;_AIRFLOW_DB_MIGRATE=true&quot;</span> --<span class="built_in">env</span> <span class="string">&quot;_AIRFLOW_WWW_USER_CREATE=true&quot;</span> --<span class="built_in">env</span> <span class="string">&quot;_AIRFLOW_WWW_USER_PASSWORD=admin&quot;</span> -v ./data/dags:/opt/airflow/dags apache/airflow:3.0.2 airflow standalone</span><br></pre></td></tr></table></figure><h2 id="如何删除dag历史记录"><a href="#如何删除dag历史记录" class="headerlink" title="如何删除dag历史记录"></a>如何删除<code>dag</code>历史记录</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 删除指定的</span></span><br><span class="line">airflow dags delete -v [dag_id]</span><br><span class="line">airflow tasks clear -v [dag_id]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除全部的</span></span><br><span class="line">airflow db clean --skip-archive --clean-before-timestamp <span class="string">&#x27;2020-01-01 00:00:00+01:00&#x27;</span> -y</span><br></pre></td></tr></table></figure><h2 id="超时相关"><a href="#超时相关" class="headerlink" title="超时相关"></a>超时相关</h2><p>运行模式有 <code>LocalExecutor</code> 和 <code>CeleryExecutor</code> 两种</p><p>都用的 <code>orphaned_tasks_check_interval</code> 和 <code>task_instance_heartbeat_timeout</code> 作为默认时间<br>也都用 <code>parallelism</code> 作为 <code>work</code> 数量</p><p>在 <code>CeleryExecutor</code> 中 可以用 <code>execution_timeout</code> 定义超时时间 部署时需要启用 <code>airflow-worker</code><br>在 <code>LocalExecutor</code> 中 开始时间为 <code>入队时间</code></p><p>心跳 在 <code>3.0.2</code> 好像有点问题 不会自己更新</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">import time</span><br><span class="line"></span><br><span class="line">from airflow import DAG</span><br><span class="line">from airflow.decorators import task</span><br><span class="line">from datetime import datetime, timedelta</span><br><span class="line"></span><br><span class="line">with DAG(</span><br><span class="line">        dag_id=&#x27;test_timeouta2&#x27;,</span><br><span class="line">        schedule=&#x27;@once&#x27;,</span><br><span class="line">        start_date=datetime(2025, 7, 10),</span><br><span class="line">        default_args=&#123;</span><br><span class="line">            &quot;execution_timeout&quot;: timedelta(seconds=86),</span><br><span class="line">        &#125;,</span><br><span class="line">) as dag:</span><br><span class="line">    @task</span><br><span class="line">    def start():</span><br><span class="line">        print(&quot;start&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @task</span><br><span class="line">    def sleep_dag_600():</span><br><span class="line">        print(&quot;start sleep 600&quot;)</span><br><span class="line">        time.sleep(600)</span><br><span class="line">        print(&quot;sleep 600 ok&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @task(execution_timeout=timedelta(seconds=96))</span><br><span class="line">    def sleep_dag_95():</span><br><span class="line">        print(&quot;start sleep 95&quot;)</span><br><span class="line">        time.sleep(95)</span><br><span class="line">        print(&quot;sleep 95 ok&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @task</span><br><span class="line">    def sleep_dag_90():</span><br><span class="line">        print(&quot;start sleep 90&quot;)</span><br><span class="line">        time.sleep(90)</span><br><span class="line">        print(&quot;sleep 90 ok&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @task</span><br><span class="line">    def sleep_dag_85():</span><br><span class="line">        print(&quot;start sleep 85&quot;)</span><br><span class="line">        time.sleep(85)</span><br><span class="line">        print(&quot;sleep 85 ok&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @task</span><br><span class="line">    def sleep_dag_60():</span><br><span class="line">        print(&quot;start sleep 60&quot;)</span><br><span class="line">        time.sleep(60)</span><br><span class="line">        print(&quot;sleep 60 ok&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @task(execution_timeout=timedelta(seconds=30))</span><br><span class="line">    def sleep_dag_30():</span><br><span class="line">        print(&quot;start sleep 30&quot;)</span><br><span class="line">        time.sleep(30)</span><br><span class="line">        print(&quot;sleep 30 ok&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @task</span><br><span class="line">    def sleep_dag_6():</span><br><span class="line">        print(&quot;start sleep 6&quot;)</span><br><span class="line">        time.sleep(6)</span><br><span class="line">        print(&quot;sleep 6 ok&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    start() &gt;&gt; [</span><br><span class="line">        sleep_dag_600(),</span><br><span class="line">        sleep_dag_95(),</span><br><span class="line">        sleep_dag_90(),</span><br><span class="line">        sleep_dag_85(),</span><br><span class="line">        sleep_dag_60(),</span><br><span class="line">        sleep_dag_30(),</span><br><span class="line">        sleep_dag_6(),</span><br><span class="line">    ]</span><br></pre></td></tr></table></figure><h1 id="参考地址"><a href="#参考地址" class="headerlink" title="参考地址"></a>参考地址</h1><ul><li><a target="_blank" rel="noopener" href="https://www.echo.cool/docs/data/airflow/">https://www.echo.cool/docs/data/airflow/</a></li><li><a target="_blank" rel="noopener" href="https://gist.github.com/worbas/c2e6d99d4fecc7cef506d90fa012d5b9">https://gist.github.com/worbas/c2e6d99d4fecc7cef506d90fa012d5b9</a></li></ul><br><div id="comment-container"></div><div id="disqus_thread"></div><div id="lv-container"></div><div class="giscus"></div></div></div></div></div><footer class="footer"><ul class="list-inline text-center"></ul><p><span>/</span> <span><a target="_blank" rel="noopener" href="https://stam1na.gitee.io">Stamina</a></span> <span>/</span></p><p><span>&copy; 2018-2025 <a href="/">puzzle9</a> </span>Created By <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> Theme <a target="_blank" rel="noopener" href="https://github.com/puzzle9/hexo-theme-aircloud-puzzle">AirCloud-puzzle9</a></p><div><span id="busuanzi_container_site_pv"><span id="busuanzi_value_site_pv"></span> PV </span><span id="busuanzi_container_site_uv"><span id="busuanzi_value_site_uv"></span> UV</span></div></footer></body><script>window.hexo_search_path="search.json",window.hexo_root="/",window.isPost=!0</script><script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><script src="/js/index.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://giscus.app/client.js" data-repo="puzzle9/puzzle9.github.io" data-repo-id="MDEwOlJlcG9zaXRvcnkxMjI2MjM4NTQ=" data-category="giscus" data-category-id="DIC_kwDOB08Xbs4CRH-Y" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="zh-CN" data-loading="lazy" crossorigin="anonymous" async></script></html>